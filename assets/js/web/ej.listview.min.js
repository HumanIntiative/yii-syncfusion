/*!
*  filename: ej.listview.min.js
*  version : 13.1.0.21
*  Copyright Syncfusion Inc. 2001 - 2015. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min","./../common/ej.touch.min","./../common/ej.listviewbase.min"],n):n()})(function(){(function(n,t,r){t.widget("ejListView","ej.ListView",{_rootCSS:"e-lv",_prefixClass:"e-",defaults:{fieldSettings:{navigateUrl:"navigateUrl",href:"href",enableAjax:"enableAjax",preventSelection:"preventSelection",persistSelection:"persistSelection",text:"text",enableCheckMark:"enableCheckMark",checked:"checked",primaryKey:"primaryKey",parentPrimaryKey:"parentPrimaryKey",imageClass:"imageClass",imageUrl:"imageUrl",childHeaderTitle:"childHeaderTitle",childId:"childId",childHeaderBackButtonText:"childHeaderBackButtonText",renderTemplate:"renderTemplate",templateId:"templateId",attributes:"attributes",mouseUp:"mouseUp",mouseDown:"mouseDown"},mouseDown:null,mouseUp:null,items:[]},dataTypes:{dataSource:"data",fieldSettings:"data",renderMode:"enum",theme:"enum",enablePersistence:"boolean"},observables:["selectedItemIndex","dataSource"],selectedItemIndex:t.util.valueFunction("selectedItemIndex"),dataSource:t.util.valueFunction("dataSource"),_tags:[{tag:"items",attr:["navigateUrl","href","text","checked","primaryKey","parentPrimaryKey","imageClass","imageUrl","childHeaderTitle","childId","childHeaderBackButtonText","mouseUP","mouseDown","attributes","renderTemplate","templateId","enableAjax","preventSelection","persistSelection","enableCheckMark","attributes",],content:"template"}],_init:function(){this._preventDefaultException={tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/};this._storedContent=[];this._storedTemplate=[];this._tempContent=n("body");this._touchStart=this.model.mouseDown;this._touchEnd=this.model.mouseUp;this._oldEle=this.element.clone();this._oldEle.find("ul").length&&(this.model.items=[]);this._indexVal=0;this._updateModelItems();this._load();this._isInsideNavigation=this.element.closest(".e-nb.e-js").length;this._nearestND=this.element.closest(".e-nb.e-js").ejNavigationDrawer("instance")},_itemsObjectCollection:function(i,r,u){var e,f;return t.getAttrVal(i,"data-ej-rendertemplate")&&(this._tempContent.find("#"+t.getAttrVal(i,"data-ej-templateid")).length?(e=this._tempContent.find("#"+t.getAttrVal(i,"data-ej-templateid")).remove(),this._storedTemplate[this._indexVal]=e[0].nodeName&&e[0].nodeName.toLowerCase()=="script"?t.getClearString(e[0].innerHTML):e[0].outerHTML):this._storedTemplate[this._indexVal]||(n(i)[0].innerHTML?this._storedTemplate[this._indexVal]=n(i)[0].innerHTML:this._storedTemplate[this._indexVal]&&this._tempContent.find("#"+template).length&&(e=this._tempContent.find("#"+template).remove(),e=e[0].nodeName&&e[0].nodeName.toLowerCase()=="script"?t.getClearString(e[0].innerHTML):e[0].outerHTML,this._storedTemplate=t._pushValue(this._storedTemplate,e,this._indexVal))),this._indexVal++),f={},f.text=t.getAttrVal(i,"data-ej-text"),f.preventSelection=t.getAttrVal(i,"data-ej-preventselection"),f.persistSelection=t.getAttrVal(i,"data-ej-persistselection"),f.navigateUrl=t.getAttrVal(i,"data-ej-navigateurl"),f.href=t.getAttrVal(i,"data-ej-href"),f.checked=t.getAttrVal(i,"data-ej-checked"),f.primaryKey=t.getAttrVal(i,"data-ej-primarykey",r),f.parentPrimaryKey=t.getAttrVal(i,"data-ej-parentprimarykey",u),n(i).attr("data-ej-parentprimarykey",u),f.imageClass=t.getAttrVal(i,"data-ej-imageclass"),f.imageUrl=t.getAttrVal(i,"data-ej-imageurl"),f.childHeaderTitle=t.getAttrVal(i,"data-ej-childheadertitle"),f.childId=f.href?t.getAttrVal(i,"data-ej-childid")?t.getAttrVal(i,"data-ej-childid"):"page_"+parseInt(Math.random().toFixed(3)*1e3):"",f.childHeaderBackButtonText=t.getAttrVal(i,"data-ej-childheaderbackbuttontext"),f.mouseUp=t.getAttrVal(i,"data-ej-mouseUp"),f.mouseDown=t.getAttrVal(i,"data-ej-mouseDown"),f.attributes=t.getAttrVal(i,"data-ej-attributes"),f.renderTemplate=t.getAttrVal(i,"data-ej-rendertemplate"),f.templateId=this._storedTemplate[this._indexVal-1],f.enableAjax=t.getAttrVal(i,"data-ej-enableajax"),f.enableCheckMark=t.getAttrVal(i,"data-ej-enablecheckmark"),f},_renderLists:function(){var n=t.buildTag("li","",{},{"class":this._prefixClass+"user-select "+this._prefixClass+"list "+this._prefixClass+"state-default{{if "+this.model.fieldSettings.primaryKey+" || "+this.model.fieldSettings.enableAjax+" || "+this.model.enableAjax+"}} "+this._prefixClass+"arrow{{/if}}{{if "+this.model.fieldSettings.imageClass+"}} "+this._prefixClass+"margin{{else}}{{if "+this.model.fieldSettings.imageUrl+"}} "+this._prefixClass+"margin{{/if}}{{/if}}","data-childid":"{{if "+this.model.fieldSettings.primaryKey+"}}child{{>"+this.model.fieldSettings.primaryKey+"}}{{else "+this.model.fieldSettings.childId+"}}{{>"+this.model.fieldSettings.childId+"}}{{else}}{{/if}}","data-childheadertitle":"{{>"+this.model.fieldSettings.childHeaderTitle+"}}","data-childheaderbackbuttontext":"{{>"+this.model.fieldSettings.childHeaderBackButtonText+"}}","data-preventSelection":"{{>"+this.model.fieldSettings.preventSelection+"}}","data-persistSelection":"{{>"+this.model.fieldSettings.persistSelection+"}}","data-navigateUrl":"{{>"+this.model.fieldSettings.navigateUrl+"}}","data-loadajax":"{{>"+this.model.fieldSettings.enableAjax+"}}","data-href":"{{>"+this.model.fieldSettings.href+"}}{{:~_checkAjaxUrls()}}","data-checked":"{{>"+this.model.fieldSettings.checked+"}}","data-templateid":"{{>"+this.model.fieldSettings.renderTemplate+"}}","data-mouseup":"{{>"+this.model.fieldSettings.mouseUp+"}}","data-mousedown":"{{>"+this.model.fieldSettings.mouseown+"}}"}),r;if(this.model.renderTemplate)this._hasDataSource()&&this._template&&(n[0].innerHTML=this._template);else{var u=t.buildTag("a","",{},{"class":this._prefixClass+"list-anchor "+this._prefixClass+"remove-shadow{{if "+this.model.fieldSettings.imageClass+"}} "+this._prefixClass+"margin{{else}}{{if "+this.model.fieldSettings.imageUrl+"}} "+this._prefixClass+"margin{{/if}}{{/if}}{{if "+this.model.fieldSettings.primaryKey+" || "+this.model.fieldSettings.enableAjax+" || "+this.model.enableAjax+"}} "+this._prefixClass+"fontimage{{/if}}",href:t.browserInfo().name=="msie"&&t.browserInfo().version<9?"":"{{if "+this.model.fieldSettings.navigateUrl+" == '' || "+this.model.fieldSettings.navigateUrl+" == undefined }}{{else}}{{:"+this.model.fieldSettings.navigateUrl+"}}{{/if}}"}),f=t.buildTag("span","{{>"+this.model.fieldSettings.text+"}}",{},{"class":this._prefixClass+"list-text "+this._prefixClass+"rel "+this._prefixClass+"user-select{{if "+this.model.fieldSettings.imageClass+"}} "+this._prefixClass+"text{{else}}{{if "+this.model.fieldSettings.imageUrl+"}} "+this._prefixClass+"text{{/if}}{{/if}}"}),e=t.buildTag("div","",{},{"class":this._prefixClass+"list-img "+this._prefixClass+"rel "+this._prefixClass+"user-select {{>"+this.model.fieldSettings.imageClass+"}}"}),i=this._createCheckBox();u[0].innerHTML=this.model.renderMode=="windows"&&t.isMobile()?"{{if !"+this.model.fieldSettings.primaryKey+"}}{{if "+this.model.fieldSettings.enableAjax+" == undefined || "+this.model.fieldSettings.enableAjax+".toString() == 'false'}}{{if !"+this.model.fieldSettings.navigateUrl+"}}{{if "+this.model.fieldSettings.enableCheckMark+" !== undefined}}{{if "+this.model.fieldSettings.enableCheckMark+".toString() == 'false' ? "+this.model.fieldSettings.enableCheckMark+" : "+this.model.enableCheckMark+"}}"+i[0].outerHTML+"{{/if}}{{else}}{{if "+this.model.enableCheckMark+"}}"+i[0].outerHTML+"{{/if}}{{/if}}{{/if}}{{/if}}{{/if}}{{if "+this.model.fieldSettings.imageClass+"}}"+e[0].outerHTML+"{{else}}{{if "+this.model.fieldSettings.imageUrl+"}}{{:~_checkImgUrls()}}{{/if}}{{/if}}"+f[0].outerHTML:"{{if "+this.model.fieldSettings.imageClass+"}}"+e[0].outerHTML+"{{else}}{{if "+this.model.fieldSettings.imageUrl+"}}{{:~_checkImgUrls()}}{{/if}}{{/if}}"+f[0].outerHTML+"{{if !"+this.model.fieldSettings.primaryKey+"}}{{if "+this.model.fieldSettings.enableAjax+" == undefined || "+this.model.fieldSettings.enableAjax+".toString() == 'false'}}{{if !"+this.model.fieldSettings.navigateUrl+"}}{{if "+this.model.fieldSettings.enableCheckMark+" !== undefined}}{{if "+this.model.fieldSettings.enableCheckMark+".toString() == 'false' ? "+this.model.fieldSettings.enableCheckMark+" : "+this.model.enableCheckMark+"}}"+i[0].outerHTML+"{{/if}}{{else}}{{if "+this.model.enableCheckMark+"}}"+i[0].outerHTML+"{{/if}}{{/if}}{{/if}}{{/if}}{{/if}}";n[0].innerHTML="{{if "+this.model.fieldSettings.renderTemplate+" == undefined || "+this.model.fieldSettings.renderTemplate+".toString() == 'false'}}"+u[0].outerHTML+"{{else}}{{:templateId}}{{/if}}"}return this.model.renderMode=="ios7"&&(r=t.buildTag("div."+this._prefixClass+"list-div"),r[0].innerHTML=n[0].innerHTML,n.empty().append(r)),n},_updateContent:function(t,i){var s=this,u=n(t),f=u.attr("data-childid"),o,e;id=this._isInsideNavigation&&t.attr("data-href")?n("body").find(n("#"+f)):this.element.find(n("#"+f));id.length&&(o=this.element.find("#"+f+"_header"),this.model.enableFiltering&&this._initializeFiltering(n(id)),e=u.attr("data-childheadertitle")==r?t.text():u.attr("data-childheadertitle"),o.hasClass("e-header")&&this._setHeaderVal(f,e,i),id.attr("data-hdr-title",e).attr("data-hdr-bckbtn",i),this._initEJCheckBox(id),this._isInsideNavigation&&t.attr("data-href")&&this._nearestND.model.contentId?n("body").find(".e-lv.subpage.e-childitem")&&n("#"+this._nearestND.model.contentId).empty().append(id.show()):(u.closest(".subpage").hide(),id.show(),n(this.element.children()[0]).removeClass("e-slideright"),id.addClass("e-slideleft")))},_renderHeader:function(n,i,r,u){var f=t.buildTag("div","",{},{id:n+"_header","class":"e-header"});return i?(f.append("<span class='e-hicon e-icon e-rarrowleft-2x'><\/span>"),f.append("<div class='e-btn-text'>"+(u?u:"Back")+"<\/div>")):f.append("<div class='e-htitle'>"+r+"<\/div>"),f},_setHeaderVal:function(i,r,u){this._onBackButtonDelegate=n.proxy(this._onBackButtonClick,this);t.listenTouchEvent(n("#"+i+"_header"),t.endEvent(),this._onBackButtonDelegate,!1,this);n("#"+i+"_header").find(".e-btn-text").text(u?u:"Back");n("#"+i+"_header").find(".e-htitle").text(r)},_onBackButtonClick:function(){this.element.find(".e-slideleft").removeClass("e-slideleft");this.element.children(":visible").hide();n(this.element.children()[0]).show();n(this.element.children()[0]).addClass("e-slideright")},_returnData:function(){var t=this._currentItem.closest("ul.e-list-hdr").find('.e-chkbox-wrap[aria-checked="true"]').closest("li");return{hasChild:this._currentItem.attr("data-childid")&&this._currentItem.attr("data-childid").length>0?this.element.find("#"+this._currentItem.attr("data-childid")).length?!0:!1:!1,item:this._currentItem,text:this._currentItem.text(),index:this._currentItem.index(),isChecked:this._currentItem.find("input.e-lv-check").closest(".e-chkbox-wrap").attr("aria-checked")=="true"?!0:!1,checkedItems:t.length?t:null,checkedItemsText:n(t).map(function(){return n(this).text()}).get()}},_initEJCheckBox:function(r){var f=r.find("li"),e=f.length,u;for(i=0;i<e;i++)u=t.getAttrVal(n(f[i]),"data-checked"),u=u=="true"?!0:!1,n(n(f[i]).find(".e-lv-check")).ejCheckBox({checked:u});r.find(".e-lv-checkdiv").removeClass("e-lv-checkdiv");r.find(".e-lv-check").parent().addClass("e-lv-checkdiv")},_triggerStartEvent:function(n){this.model.mouseDown=t.getAttrVal(this._currentItem,"data-mousedown",this._touchStart);this.model.mouseDown&&this._trigger("mouseDown",n)},_triggerEndEvent:function(n){this.model.mouseUp=t.getAttrVal(this._currentItem,"data-mouseup",this._touchEnd);this.selectedItemIndex(this._currentItem.index());this.model.mouseUp&&this._trigger("mouseUp",n)},_createFilterDiv:function(){return t.buildTag("div.e-lv-filter",t.buildTag("input.e-lv-input","",{},{type:"text",placeholder:"search"}))},_emptyFilterTextValue:function(n){n.find(".e-lv-input").val("")},_createListDiv:function(n){this._div=t.buildTag("div#"+n+"."+this._rootCSS+" subpage e-childitem e-ajaxchild",this.model.showHeader&&this._isInsideNavigation&&!this._nearestND.model.contentId?this._renderHeader(n,!0,this._currentItem.text()):"")},_createCheckBox:function(){return t.buildTag("input.e-lv-check","",{},{type:"checkbox"})},_toggleCheckboxValue:function(t){t.ejCheckBox({checked:n(t.closest(".e-chkbox-wrap")).attr("aria-checked")=="true"?!1:!0})},_setCheckboxValue:function(n,t){n.ejCheckBox({checked:t})},_convertToRelativeUrl:function(n){return n}});n.extend(!0,t.ListView.prototype,t.ListViewBase.prototype)})(jQuery,Syncfusion)})