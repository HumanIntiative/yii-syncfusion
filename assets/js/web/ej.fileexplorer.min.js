/*!
*  filename: ej.fileexplorer.min.js
*  version : 13.1.0.21
*  Copyright Syncfusion Inc. 2001 - 2015. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min","./../common/ej.data.min","./../common/ej.draggable.min","./../common/ej.scroller.min","./ej.button.min","./ej.treeview.min","./ej.uploadbox.min","./ej.waitingpopup.min","./ej.dialog.min","./ej.splitter.min","./ej.toolbar.min","./ej.menu.min","./ej.grid.min"],n):n()})(function(){(function(n,t,i){t.widget("ejFileExplorer","ej.FileExplorer",{element:null,model:null,validTags:["div"],_rootCSS:"e-fileexplorer",defaults:{fileTypes:"*.png,*.gif,*.jpg,*.jpeg",filterSettings:{caseSensitiveSearch:!1,filterType:"startswith"},showToolbar:!0,showTreeview:!0,showLayout:!0,showContextMenu:!0,showFooter:!0,layout:"grid",locale:"en-US",gridSettings:{allowSorting:!0,allowSearching:!0,columns:[{field:"name",headerText:"Name",width:140},{field:"type",headerText:"Type",width:95},{field:"size",headerText:"Size",width:90},{field:"dateModified",headerText:"Date Modified",width:140}]},tools:{creation:["NewFolder"],navigation:["Back","Forward"],addressBar:["Addressbar"],editing:["Refresh","Upload","Delete","Rename","Download"],copyPaste:["Cut","Copy","Paste"],getProperties:["Details"],searchBar:["Searchbar"]},toolsList:["searchBar","creation","navigation","addressBar","editing","copyPaste","getProperties"],path:"",height:400,width:827,isResponsive:!1,enableResize:!0,cssClass:"",enableRTL:!1,ajaxAction:"",ajaxSettings:{read:{},createFolder:{},destroy:{},rename:{},paste:{},getDetais:{},download:{},upload:{}},layoutChange:null,select:null,createFolder:null,remove:null,move:null,copy:null,open:null},dataTypes:{fileTypes:"string",layout:"enum",filterSettings:"data",path:"string",ajaxAction:"data",cssClass:"string",gridSettings:"data",toolsList:"array",tools:{creation:"array",navigation:"array",addressBar:"array",editing:"array",copyPaste:"array",getProperties:"array",searchBar:"array"}},_setModel:function(n){var i,u,f,r,e;for(i in n)switch(i){case"showToolbar":this.model.showToolbar||(this._paneHeight=this._toolBarItems.outerHeight());n[i]?t.isNullOrUndefined(this._toolBarItems)?this._renderToolBar():this._toolBarItems.show():this._toolBarItems.hide();this.element.outerHeight(this.model.showToolbar?this.element.outerHeight()+this._paneHeight:this.element.outerHeight()-this._paneHeight);this.model.height=this.element.outerHeight();break;case"showTreeview":case"showLayout":this._showHideSplitBar();break;case"showContextMenu":this._showHideContextMenu();break;case"height":this.element.css("height",this.model.height);this._splittag.outerHeight(this.element.height()-((this._toolBarItems?this._toolBarItems.outerHeight():0)+(this._actionbar?this._actionbar.outerHeight():0)));break;case"width":this.element.css("width",this.model.width);u=this._splittag.data("ejSplitter");u.refresh();break;case"layout":this.model.path=this._originalPath;this.model.layout=="grid"?(this._tileContent.parent().hide(),this._gridtag.show(),this._renderGridView(this._fileExplorer[this.model.path])):(this._gridtag.hide(),this._renderTileView(this._fileExplorer[this.model.path]),this._tileContent.parent().show());f={layoutType:this.model.layout};this._trigger("layoutChange",f);break;case"path":n[i]?this._setPath():this._getPath();break;case"enableRTL":this._enableRTL(n[i]);break;case"showFooter":n[i]?(this._statusbar.hasClass("e-statusbar")?(r=this._splittag.find(".e-cont2").height()-this._statusbar.height()-1,this._tileView.height(r),this._gridtag.height(r),this._statusbar.show()):this._createStatusBar(),e=this._splittag.height()-this._gridtag.find(".e-gridheader").outerHeight(),this._tileContent.parent(".e-tile-wrapper").ejScroller({height:this._splittag.height()-this._statusbar.height()-1,scrollerSize:this._scrollerSize})):(this._tileView.height("auto"),this._gridtag.height("auto"),this._statusbar.hide(),e=this._splittag.height()-this._gridtag.find(".e-gridheader").outerHeight(),this._tileContent.parent(".e-tile-wrapper").ejScroller({height:this._splittag.height(),scrollerSize:this._scrollerSize}));break;case"filterSettings":this._gridtag.ejGrid({filterSettings:n[i]});break;case"gridSettings":this._gridtag.ejGrid(n[i]);break;case"locale":this.model.path=this._rootPath;this._destroy();this._init();break;case"cssClass":this._changeSkin(n[i])}},_init:function(){this._initialize();this._render();this._enableRTL(this.model.enableRTL);this._wireEvents();this._wireResizing()},_initialize:function(){this._ExplorerId=this.element[0].id;this._fileExplorer={};this._selectedStates=[];this._updateOnNodeSelection=!1;this._tileView=null;this._originalPath=null;this._rootPath=this.model.path;this._initPath="";this._initUpdate=!1;this._scrollerSize=8;this._editingToolsState=!0;this.element.css("height",this.model.height);this.element.css("width",this.model.width);this._initContextMenuOptions();this._isTreeNode=!1;this._selectedItems=[];this._downloadDialog=null;this._newFolderDialog=null;this._renameDialog=null;this._openDialog=null;this._detailsDialog=null;this._alertDialog=null},_initContextMenuOptions:function(){this._menuOpen=this._getLocalizedLabels("ContextMenuOpen");this._menuDownload=this._getLocalizedLabels("ContextMenuDownload");this._menuCut=this._getLocalizedLabels("ContextMenuCut");this._menuCopy=this._getLocalizedLabels("ContextMenuCopy");this._menuPaste=this._getLocalizedLabels("ContextMenuPaste");this._menuGetinfo=this._getLocalizedLabels("ContextMenuGetinfo");this._menuNewFolder=this._getLocalizedLabels("ContextMenuNewFolder");this._menuDelete=this._getLocalizedLabels("ContextMenuDelete");this._menuRename=this._getLocalizedLabels("ContextMenuRename");this._menuUpload=this._getLocalizedLabels("ContextMenuUpload")},_render:function(){this.element.attr("role","fileexplorer");this.model.showToolbar&&this._renderToolBar();this._createSplitPane();this._read()},_read:function(){var r=this,t={data:{ActionType:"Read",Path:this.model.path,ExtensionsAllow:this.model.fileTypes},url:this.model.ajaxAction,type:"POST",async:!1,success:function(n){r._readSuccess(n)}};this.model.ajaxSettings.read.success=i;n.extend(!0,t,this.model.ajaxSettings.read);this._sendAjaxRequest(t)},_sendAjaxRequest:function(i,r){r||this._waitingPopup.show();var u=this;n.ajax({data:JSON.stringify(i.data),url:i.url,type:i.type,async:i.async,success:i.success,contentType:"application/json",dataType:"json",error:i.error?i.error:function(n,i,r){u._alertDialog=u._createDialog(t.buildTag("div.e-fe-dialog-label e-fe-center",n.status+" "+r+"<br/>"+u._getLocalizedLabels("GeneralError")),{width:400,height:100})},beforeSend:i.beforeSend,complete:function(){u._waitingPopup.hide();i.complete}})},_readSuccess:function(n){var i,t;for(this._update=!1,i=0,t=0;t<n.length;t++)i+=n[t].size,n[t].sizeInByte=n[t].size,n[t].size=this._bytesToSize(n[t].size);i=this._bytesToSize(i);this._fileExplorer[this.model.path]=n;this._itemStatus.html(n.length+" "+(n.length==1?this._getLocalizedLabels("Item"):this._getLocalizedLabels("Items"))+", "+this._getLocalizedLabels("Size")+": "+i);this._treetag.hasClass("e-treeview")||(this._renderTreeView(n),this._updateOnNodeSelection=!0);this.model.showLayout&&this.model.layout=="grid"?this._renderGridView(n):this._renderTileView(n)},_bytesToSize:function(n){var t,i;return n==0?"0 Byte":(t=parseInt(Math.floor(Math.log(n)/Math.log(1024))),i=n/Math.pow(1024,t),i.toFixed(2)+" "+["Bytes","KB","MB","GB","TB"][t])},_setPath:function(n){this.model.path=n;this._treetag.remove();this._treetag=t.buildTag("div#"+this._ExplorerId+"_treeView");this._splittag.find(".e-cont1").append(this._treetag);this._selectedStates=[];this._initUpdate=!1;this._initPath="";this._read()},_getPath:function(){return this.model.path},disableToolbarItem:function(n){t.isNullOrUndefined(n)||this._toolBarItems.ejToolbar("disableItemByID",n)},enableToolbarItem:function(n){t.isNullOrUndefined(n)||this._toolBarItems.ejToolbar("enableItemByID",n)},_changeSkin:function(n){this.element.removeClass(this.model.cssClass).addClass(n);this._subControlsSetModel("cssClass",n)},_enableRTL:function(n){n?(this.element.addClass("e-rtl"),this.element.find(".e-scroller").addClass("e-rtl")):(this.element.removeClass("e-rtl"),this.element.find(".e-scroller").removeClass("e-rtl"));this._subControlsSetModel("enableRTL",n)},_destroy:function(){this.element.children().remove();this._unwireEvents();this._treeContextMenutag&&this._treeContextMenutag.parent().remove();this._tileContextMenutag&&this._tileContextMenutag.parent().remove();this._downloadDialog&&this._downloadDialog.parents(".e-dialog").remove();this._newFolderDialog&&this._newFolderDialog.parents(".e-dialog").remove();this._renameDialog&&this._renameDialog.parents(".e-dialog").remove();this._openDialog&&this._openDialog.parents(".e-dialog").remove();this._detailsDialog&&this._detailsDialog.parents(".e-dialog").remove()},_createFolder:function(r){var u=this,f={data:{ActionType:"CreateFolder",Name:r,Path:this.model.path},url:this.model.ajaxAction,type:"POST",success:function(n){if(u._update=!0,u._treeObj.selectNode(u._selectedNode),n){var t=[{id:n,name:n,spriteCssClass:"e-tree-foldericon",hasChild:!1}];u._treeObj.addNode(t,u._treeObj.getSelectedNode())}u._trigger("createFolder")},error:function(){u._selectedNode&&(u._alertDialog=u._createDialog(t.buildTag("div.e-fe-dialog-label e-fe-center",u._getLocalizedLabels("ErrorOnFolderCreation")),{width:400,height:100}))}};this.model.ajaxSettings.createFolder.success=i;n.extend(!0,f,this.model.ajaxSettings.createFolder);this._sendAjaxRequest(f)},_cut_copy:function(){this._removeBlurEffect();var t=this,r={data:{ActionType:"Paste",LocationFrom:this._soucePath,LocationTo:this.model.path,Name:this._fileName,Type:this._sourceType,Action:this._option},url:this.model.ajaxAction,type:"POST",success:function(){var n;t._option=="move"&&(t._sourceType=="Directory"&&t._treeObj.removeNode(t._refreshNode),t._fileExplorer[t._sourceType=="Directory"?t._soucePath.replace(t._fileName+"/",""):t._soucePath]="");t._refreshItems(t._selectedNode,t.model.path);t._option=="move"?(n={name:t._fileName,targetPath:t.model.path},t._trigger("move",n)):(n={name:t._fileName,targetPath:t.model.path},t._trigger("copy",n))}};this.model.ajaxSettings.paste.success=i;n.extend(!0,r,this.model.ajaxSettings.paste);this._sendAjaxRequest(r)},_deletion:function(t,r){var u=this,f={data:{ActionType:"Delete",Name:""+t,Path:r},traditional:!0,url:this.model.ajaxAction,type:"POST",success:function(){u._selectedItemsTag.html("");u._fileExplorer[u._ajax_folderPath]="";u._nodeType=="Directory"?(u._fileExplorer[u.model.path]="",u._treeObj.removeNode(u._selectedNode),u._treeObj.selectNode(u._parentNode)):u._treeObj.selectNode(u._selectedNode);var n={path:u._ajax_folderPath,itemType:u._nodeType};u._trigger("remove",n)}};this.model.ajaxSettings.destroy.success=i;n.extend(!0,f,this.model.ajaxSettings.destroy);this._sendAjaxRequest(f)},_rename:function(r,u,f,e){var o=this,s={data:{ActionType:"Rename",Path:r,PreviousName:u,Newname:f,Type:e},url:this.model.ajaxAction,type:"POST",success:function(){for(var t=o.model.path,r=!0,i=0;i<o._fileExplorer[t].length;i++)o._fileExplorer[t][i].name==o._selectedContent&&(o._fileExplorer[t][i].name=o._ajax_person,o.model.showLayout&&o.model.layout=="grid"?o._renderGridView(o._fileExplorer[t]):o._renderTileView(o._fileExplorer[t]),r=!1);o._nodeType=="Directory"&&(n(o._selectedNode).text(o._ajax_person),o._treeObj.selectNode(o._parentNode));r&&(o._fileExplorer[t]="")},error:function(){o._selectedNode&&(o._alertDialog=o._createDialog(t.buildTag("div.e-fe-dialog-label e-fe-center",o._getLocalizedLabels("ErrorOnFolderCreation")),{width:400,height:100}))}};this.model.ajaxSettings.rename.success=i;n.extend(!0,s,this.model.ajaxSettings.rename);this._sendAjaxRequest(s)},_downloadFile:function(){var n=this,u=t.buildTag("div"),s=t.buildTag("div.e-fe-dialog-label e-fe-center",this._getLocalizedLabels("DownloadAlert")+" "+this._selectedContent),f=this.model.ajaxAction+"?Path="+this.model.path+this._selectedContent+"&ActionType=Download",r;this.model.ajaxSettings.download.url&&(this.model.ajaxSettings.download.url.indexOf("{")>=0&&(this.model.ajaxSettings.download.url=String.format(this.model.ajaxSettings.download.url,"?Path="+n.model.path+this._selectedContent)),f=this.model.ajaxSettings.download.url);var i=t.buildTag("a","","",{id:this._ExplorerId+"_a",href:f}),e=t.buildTag("div.e-fe-dialog-centerbtn"),o=t.buildTag("button.e-fe-btn-ok",this._getLocalizedLabels("YesButton"));i.append(o);r=t.buildTag("button.e-fe-btn-cancel",this._getLocalizedLabels("NoButton"));o.ejButton({click:function(){i.click();n._downloadDialog.ejDialog("close")}});r.ejButton({click:function(){n._downloadDialog.ejDialog("close")}});e.append(i,r);u.append(s,e);this._downloadDialog=this._createDialog(u,{width:334,height:125})},_removeBlurEffect:function(){this._currntNode&&(this._currntNode.hasClass("e-active")&&this._currntNode.removeClass("e-blur"),this._currntNode.find(".e-active").length&&this._currntNode.find(".e-active").removeClass("e-blur"))},_renderTreeView:function(t){var i,r,u,f;for(this._collapse=!1,i=this,r=this.model.path.split("/"),u=0;u<r.length-2;u++)this._initPath+=r[u]+"/";f=r[r.length-2];this._localData=[{id:1,name:f,spriteCssClass:"e-tree-foldericon",hasChild:!0}];this._treetag._collapse=!1;this._treetag.ejTreeView({loadOnDemand:!0,cssClass:i.model.cssClass,enableRTL:i.model.enableRTL,fields:{dataSource:i._localData,id:"id",parentId:"pid",text:"name",hasChild:"hasChild",spriteCssClass:"spriteCssClass"},nodeCollapse:function(n){i._refreshTreeScroller(n)},nodeExpand:function(n){i._refreshTreeScroller(n)},nodeClick:function(n){i._treenodeClicked(n)},beforeExpand:function(n){i._treeNodeBeforeExpand(n)},nodeSelect:function(n){i._updateTreePath(n)},beforeCollapse:function(n){i._onBeforeCollapse(n)}});this._treeObj=this._treetag.data("ejTreeView");this._treetag.ejTreeView("selectNode",n(this._treetag).find("li")[0]);this._treetag.parent(".e-tree-wrapper").ejScroller({height:this._splittag.height(),width:this._splittag.find(".e-cont1").width(),buttonSize:0,scrollerSize:this._scrollerSize});this._addChild(t)},_treeNodeBeforeExpand:function(n){this._nodeExpanded||(this._treetag.ejTreeView("selectNode",n.currentElement),this._treetag.ejTreeView("hasChildNode",n.currentElement)||this._addChild(this._fileExplorer[this.model.path]))},_treenodeClicked:function(t){this._selectedContent=t.currentElement.text;this._selectedNode=n(t.currentElement);this._parentNode=n(t.currentElement).parents("li.e-item")[1];this._nodeType="Directory";this._parentNode?this._enableEditingTools():this._disableEditingTools();this._isTreeNode=!0},_showHideContextMenu:function(){if(this.model.showContextMenu){var i={beforeOpen:"",click:""},u,r={id:"",targetId:""},t={"class":"e-fe-separator"};u=[{text:this._menuDelete,sprite:"e-fileexplorer-toolbar-icon Delete",htmlAttr:t},{text:this._menuCut,sprite:"e-fileexplorer-toolbar-icon Cut"},{text:this._menuCopy,sprite:"e-fileexplorer-toolbar-icon Copy"},{text:this._menuPaste,sprite:"e-fileexplorer-toolbar-icon Paste",htmlAttr:t},{text:this._menuRename,sprite:"e-fileexplorer-toolbar-icon Rename"},{text:this._menuNewFolder,sprite:"e-fileexplorer-toolbar-icon NewFolder"},{text:this._menuUpload,sprite:"e-fileexplorer-toolbar-icon Upload",htmlAttr:t},{text:this._menuGetinfo,sprite:"e-fileexplorer-toolbar-icon Details"}];r.id=this._ExplorerId+"_treeView";r.targetId="#"+this._ExplorerId+"_treeView";i.beforeOpen=n.proxy(this._beforeOpenContextMenu,this);i.click=n.proxy(this._contextMenuClick,this);this._treeContextMenutag=this._createContextMenuTag(u,r,i);u=[{text:this._menuOpen,sprite:"e-fileexplorer-toolbar-icon Open"},{text:this._menuDownload,sprite:"e-fileexplorer-toolbar-icon Download",htmlAttr:t},{text:this._menuCut,sprite:"e-fileexplorer-toolbar-icon Cut"},{text:this._menuCopy,sprite:"e-fileexplorer-toolbar-icon Copy"},{text:this._menuPaste,sprite:"e-fileexplorer-toolbar-icon Paste",htmlAttr:t},{text:this._menuDelete,sprite:"e-fileexplorer-toolbar-icon Delete",htmlAttr:t},{text:this._menuRename,sprite:"e-fileexplorer-toolbar-icon Rename"},{text:this._menuNewFolder,sprite:"e-fileexplorer-toolbar-icon NewFolder"},{text:this._menuUpload,sprite:"e-fileexplorer-toolbar-icon Upload",htmlAttr:t},{text:this._menuGetinfo,sprite:"e-fileexplorer-toolbar-icon Details"}];r.id=this._ExplorerId+"_tileView";r.targetId=".e-tile-wrapper,#"+this._ExplorerId+"_grid";i.beforeOpen=n.proxy(this._beforeOpenTileContextMenu,this);i.click=n.proxy(this._fileContextMenuClick,this);this._tileContextMenutag=this._createContextMenuTag(u,r,i)}else this._treeContextMenutag&&this._tileContextMenutag&&(this._treeContextMenutag.ejMenu("destroy"),this._tileContextMenutag.ejMenu("destroy"))},_renderGridView:function(n){var t=this;this._gridtag.ejGrid({cssClass:t.model.cssClass,enableRTL:t.model.enableRTL,dataSource:n,selectionType:"multiple",selectionSettings:{enableToggle:!0},allowSorting:t.model.gridSettings.allowSorting,allowSearching:t.model.gridSettings.allowSearching,columns:t.model.gridSettings.columns,isResponsive:!0,scrollSettings:{width:186,height:200},allowScrolling:!0,enableResponsiveRow:!1,filterSettings:{enableCaseSensitivity:t.model.filterSettings.caseSensitiveSearch,filterType:t.model.filterSettings.filterType},rowSelected:function(n){t._updatePathFromGrid(n)},recordDoubleClick:function(n){t._openAction(n)}});this._gridObj=this._gridtag.ejGrid("instance");this._reSizeHandler()},_renderTileView:function(i){this._tileView.children()&&this._tileView.children().remove()&&this._tileView.removeClass("e-tileview");this._tileView.appendTo(this._tileContent);this._tileView.addClass("e-tileview").attr("role","tileview");i.length==0?this._tileView.html("No items to display"):this._tileView.html("");var u=this,r=null;n.each(i,function(i,f){var e=n("<li class='e-tilenode'><\/li>"),o,s;f.type=="File"?/\.(gif|jpg|jpeg|tiff|png|bmp)$/i.test(f.name)?(o=t.buildTag("img.e-thumbImage","","",{src:u.model.path.replace("~","..")+f.name}),o.appendTo(e)):(r=n("<span class='e-nonImage-icon'><\/span>"),r.appendTo(e)):(r=n("<span class='e-folder-icon'><\/span>"),r.appendTo(e));s=n("<div class='e-name'>"+f.name+"<\/div>");e.attr({"aria-selected":!1,title:f.dateModified+" ("+f.size+")",role:"tileitem"});s.appendTo(e);e.appendTo(u._tileView)});this._activeItem=0;this.items=this._tileView.find("li.e-tilenode");this._tileViewEvents("_on");this._tileContent.addClass("e-content");this._tileContent.parent(".e-tile-wrapper").hasClass("e-scroller")||this._tileContent.parent(".e-tile-wrapper").ejScroller({height:this.model.showFooter?this._splittag.height()-this._statusbar.height()-1:this._splittag.height(),width:"100%",buttonSize:0,scrollerSize:this._scrollerSize});this._tileContent.parent(".e-tile-wrapper").ejScroller("refresh")},_gridtagClick:function(t){t.stopPropagation();(n(t.target).hasClass("e-gridcontent")||n(t.target).hasClass("e-content")||n(t.target).hasClass("e-table"))&&(this._gridObj.clearSelection(),this._removeOldSelectionDetails())},_tileViewEvents:function(n){this[n](this.items,"click",this._upDatePathFromTileView);this[n](this.items,"dblclick",this._openAction);this[n](this.items,"mouseenter",this._onItemHover);this[n](this.items,"mouseleave",this._onItemLeave);this[n](this._tileView,"focus",this._focusTileView)},_tileViewWrapperClick:function(t){(n(t.target).hasClass("e-tile-wrapper")||n(t.target).hasClass("e-tile-content")||n(t.target).hasClass("e-tileview"))&&(this.items.hasClass("e-active")&&this.items.removeClass("e-active"),this._removeOldSelectionDetails())},_onItemHover:function(t){var i=t.currentTarget,r=t.target;n(i).hasClass("e-disable")||(this.items.removeClass("e-hover"),n(i).addClass("e-hover"))},_onItemLeave:function(t){var i=t.currentTarget,r=t.target;n(i).hasClass("e-disable")||n(i).removeClass("e-hover")},_focusTileView:function(){this._tileView.addClass("e-focus");this._on(this._tileView,"keydown",this._OnKeyDown)},_OnKeyDown:function(n){var t=this._itemList.length-1;switch(n.keyCode){case 38:case 37:n.preventDefault();this._removeListHover();this._activeItem<0||this._activeItem==null||this._activeItem>t?this._activeItem=0:this._activeItem==0?this._activeItem=t:this._activeItem-=1;this._beforeListHover();break;case 40:case 39:n.preventDefault();this._removeListHover();this._activeItem>t||this._activeItem==null||this._activeItem<0?this._activeItem=t:this._activeItem==t?this._activeItem=0:this._activeItem+=1;this._beforeListHover();break;case 33:case 36:n.preventDefault();this._removeListHover();this._activeItem=0;this._beforeListHover();break;case 34:case 35:n.preventDefault();this._removeListHover();this._activeItem=t;this._beforeListHover()}},_OnKeyUp:function(t){var i;switch(t.keyCode){case 13:t.preventDefault();i=this._getActiveItem();i.hasClass("e-disable")||(i.click(),(i.hasClass("e-tilenode")||n(t.target).find(".e-selectionbackground").length)&&this._openAction())}},_removeListHover:function(){n(this._itemList).removeClass("e-hover")},_beforeListHover:function(){activeItem=this._getActiveItem();activeItem.hasClass("e-disable")||this._addListHover()},_addListHover:function(){var n=this._getActiveItem();n.addClass("e-hover");n.focus()},_getActiveItem:function(){return n(n(this._itemList)[this._activeItem])},_getURL:function(){var n=this.model.ajaxAction+"?Path="+this.model.path+"&ActionType=Upload";return this.model.ajaxSettings.upload.url&&(n=this.model.ajaxSettings.upload.url.indexOf("{")>=0?String.format(this.model.ajaxSettings.upload.url,"?Path="+this.model.path):this.model.ajaxSettings.upload.url),n},_renderUploadBox:function(){var n=this,i=this._getURL();this._uploadtag.ejUploadbox({cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,height:"0px",width:"0px",buttonText:{browse:"Upload file"},saveUrl:i,removeUrl:this.model.ajaxAction+"?Path="+this.model.path+"&ActionType=Delete",locale:t.Uploadbox.Locale[this.model.locale]?this.model.locale:"en-US",complete:function(t){n._uploadSuccess(t)},remove:function(t){n._uploadSuccess(t)},begin:function(){n._uploadtag.ejUploadbox({saveUrl:n._getURL()})}})},_uploadSuccess:function(){this._uploadtag.find(".e-dialog.e-js .e-action-perform").remove();this._fileExplorer[this.model.path]="";this._treeObj.selectNode(this._selectedNode)},_createAddressBar:function(){this._addresstag=t.buildTag("input.e-addressBar e-tool-input","",{},{id:this._ExplorerId+"_addressbar",type:"text"});this._addresstag.appendTo(this._toolBarItems.find("#"+this._ExplorerId+"Addressbar").html(""));var i=n("<span class='e-addressbar-foldericon'><\/span>");i.insertBefore(this._addresstag)},_updateAddressBar:function(){if(this._addresstag){var n=this.model.path;this._addresstag.val(n.replace(this._initPath,""))}},_onEpand:function(n){proxy=this.element.parents(".e-fileexplorer").ejFileExplorer("instance");proxy.model.showLayout&&!proxy.model.showTreeview&&proxy.element.find(".e-cont2").width(proxy.model.width);proxy._reSizeHandler(n)},_createSplitPane:function(){var f=this,i=t.buildTag("div"),n=t.buildTag("div"),u,r;this._splittag=t.buildTag("div#"+this._ExplorerId+"_splitter");i.addClass("e-cont1");n.addClass("e-cont2");this._splittag.append(i,n);this.element.append(this._splittag);this._splittag.ejSplitter({enableAutoResize:!0,height:this.element.height()-((this._toolBarItems?this._toolBarItems.outerHeight():0)+(this._actionbar?this._actionbar.outerHeight():0)),properties:[{paneSize:Math.ceil(this._splittag.outerWidth()/4)},{}],resize:function(n){f._reSizeHandler(n)}});u=this._splittag.find(".e-cont2").width();this._splittag.find(".e-cont2").width(u+6);this._splittag.ejSplitter("option","expandCollapse",this._onEpand);r=t.buildTag("div.e-tree-wrapper");i.append(r);this._treetag=t.buildTag("div#"+this._ExplorerId+"_treeView");r.append(this._treetag);this._gridtag=t.buildTag("div#"+this._ExplorerId+"_grid");n.append(this._gridtag);this._tileViewWrapper=t.buildTag("div.e-tile-wrapper");n.append(this._tileViewWrapper);this._tileViewWrapper.append("<div class='e-tile-content'> <\/div>");this._tileContent=this._tileViewWrapper.find(".e-tile-content");this._tileView=t.buildTag("ul#"+this._ExplorerId+"_tileView");this._tileContent.append(this._tileView);this._statusbar=t.buildTag("div");this._statusbar.insertAfter(this._tileView);n.append(this._statusbar);this.model.showFooter&&this._createStatusBar();this._waitingPopup=this._splittag.find(".e-cont2").ejWaitingPopup({showOnInit:!1}).data("ejWaitingPopup");this._showHideSplitBar();this._showHideContextMenu();this.model.layout=="grid"?this._tileContent.parent().hide():this._gridtag.hide();this._createUploadBox()},_refreshTreeScroller:function(){this._treetag.hasClass("e-content")&&this._treetag.addClass("e-content");this._treetag.parent(".e-tree-wrapper").ejScroller("refresh")},_createStatusBar:function(){var i,r,n;this._statusbar.addClass("e-statusbar");this._itemStatus=t.buildTag("div.e-itemStaus");this._selectedItemsTag=t.buildTag("div.e-itemStaus e-selected-items");i=t.buildTag("div.e-switchView");this._statusbar.append(this._itemStatus,this._selectedItemsTag,i);r=this._splittag.find(".e-cont2").height()-this._statusbar.height()-1;this._gridtag.height(r);n=t.buildTag("button.e-switchGridView#"+this._ExplorerId+"_switchGridView","",{},{title:this._getLocalizedLabels("Grid")});i.append(n);n.ejButton({size:"normal",contentType:"imageonly",prefixIcon:"e-switchGridView-icon"});n=t.buildTag("button.e-swithListView#"+this._ExplorerId+"_swithListView","",{},{title:this._getLocalizedLabels("Tile")});i.append(n);n.ejButton({size:"normal",contentType:"imageonly",prefixIcon:"e-swithListView-icon"});this.model.layout=="grid"?this._statusbar.find(".e-switchGridView-icon").addClass("e-active-color"):this._statusbar.find(".e-swithListView-icon").addClass("e-active-color")},_showHideSplitBar:function(){if(splitObj=this._splittag.data("ejSplitter"),this._splittag.show(),splitObj.model.properties[1].paneSize==0)this.element.find(".e-splitbar").show(),splitObj.expand(1),this._gridtag.hasClass("e-grid")||this._updateData();else if(splitObj.model.properties[0].paneSize==0){this.element.find(".e-splitbar").show();var n=proxy._splittag.outerWidth();proxy.element.find(".e-cont2").width(n-this.element.find(".e-splitbar").outerWidth());splitObj.expand(0)}this.model.showLayout&&!this.model.showTreeview?(splitObj.collapse(0),this.element.find(".e-splitbar").hide(),this._gridtag.hasClass("e-grid")||this._updateData()):this.model.showTreeview&&!this.model.showLayout?(splitObj.collapse(1),this.element.find(".e-splitbar").hide()):this.model.showLayout||this.model.showTreeview||this._splittag.hide()},_updateTreePath:function(i){var r,i;if(this._removeBlurEffect(),this._searchbar&&this._searchbar.val(""),this._selectedContent=i.value,this._selectedNode=i.currentElement,this._parentNode=this._selectedNode.parent().parent().find("a")[0],this._selectedNode=this._selectedNode.find("a")[0],this._nodeType="Directory",!this._isStateNavigation){if(!t.isNullOrUndefined(this._currentState)){for(r=this._selectedStates.length-1;r>this._currentState;r--)this._selectedStates.pop();this._toolBarItems&&this._disableToolbarItem("Forward")}this._selectedStates[this._selectedStates.length-1]!=this._selectedNode&&(this._currentState=this._selectedStates.length,this._selectedStates.push(this._selectedNode),this._selectedStates.length==2&&this._toolBarItems&&this._enableToolbarItem("Back"))}this._updatePath(i.currentElement,i.value);this._updateOnNodeSelection&&this._updateData();this._originalPath=this.model.path;this._updateAddressBar();this._currntNode=n(this._selectedNode);i={name:this._selectedContent,itemType:this._nodeType,path:this.model.path};this._trigger("select",i);this._toolBarItems&&this._disableToolbarItem("Download")},_onBeforeCollapse:function(){this._collapse=!0},_updatePath:function(t,i){for(var u="",r=0;r<t.parents("ul").length-1;r++)n(t.parents("ul")[r]).siblings("div").find("a").text()&&(u=n(t.parents("ul")[r]).siblings("div").find("a").text()+"/"+u);this._initUpdate?this.model.path=this._initPath+u+i+"/":this._initUpdate=!0},_updatePathFromGrid:function(t){var f,e,u,i,r,t;for(this._isTreeNode=!1,f="",this._selectedItems=[],e=0,u=this._gridtag.ejGrid("getSelectedRecords"),i=0;i<u.length;i++)this._selectedItems.push(u[i].name),e+=u[i].sizeInByte;if(this.model.path!=this._originalPath&&(this.model.path=this._originalPath,this._selectedNode=this._parentNode),t.data.type=="Directory"){for(this.model.path+=t.data.name+"/",this._parentNode=this._selectedNode,r=0;r<this._treeObj.getSelectedNode().find(".e-text").length;r++)this._treeObj.getSelectedNode().find(".e-text")[r].text==t.data.name&&(this._selectedNode=n(this._treeObj.getSelectedNode().find(".e-text")[r].parentNode.parentNode).find("a")[0]);this._toolBarItems&&this._disableToolbarItem("Download")}else this._toolBarItems&&this._enableToolbarItem("Download");this._currntNode=t.target&&t.target.parent("tr");this._selectedContent=t.data.name;this._selectedItemsTag.html((this._selectedItems.length>1?this._selectedItems.length+" items Selected ":t.data.name)+",  "+this._bytesToSize(e));this._nodeType=t.data.type;f=this._getFileURL();t={name:this._selectedContent,itemType:this._nodeType,path:f};this._urlTag&&this._urlTag.find("input").val(t.path);this._nameTag&&this._nameTag.find("input").val(t.name);this._trigger("select",t);this._enableEditingTools()},_enableEditingTools:function(){var i=this,t,n;if(!this._editingToolsState&&this._toolBarItems){for(t=["Rename","Delete","Cut","Copy"],n=0;n<t.length;n++)i._enableToolbarItem(t[n]);this._editingToolsState=!0}},_enableToolbarItem:function(n){this._toolBarItems.find("#"+this._ExplorerId+n).hasClass("e-disable")&&this._toolBarItems.ejToolbar("enableItemByID",this._ExplorerId+n)},_disableToolbarItem:function(n){this._toolBarItems.find("#"+this._ExplorerId+n).hasClass("e-disable")||this._toolBarItems.ejToolbar("disableItemByID",this._ExplorerId+n)},_disableEditingTools:function(){var i=this,t,n;if(this._toolBarItems){for(t=["Rename","Delete","Cut","Copy"],n=0;n<t.length;n++)i._disableToolbarItem(t[n]);this._editingToolsState=!0;this._editingToolsState=!1}},_upDatePathFromTileView:function(t){var e,r,u,i,f;if(t.stopPropagation(),this._isTreeNode=!1,t.ctrlKey||(this._sizeInByte=0,this._selectedItems=[],n(t.currentTarget).siblings().removeClass("e-active").attr("aria-selected",!1)),n(t.currentTarget).hasClass("e-active")?n(t.currentTarget).removeClass("e-active").attr("aria-selected",!1):n(t.currentTarget).addClass("e-active").attr("aria-selected",!0),e="File",r=n(t.currentTarget).find(".e-name").text(),this.model.path!=this._originalPath&&(this.model.path=this._originalPath,this._selectedNode=this._parentNode),n(t.currentTarget).find(".e-folder-icon").length){for(e="Directory",this.model.path+=r+"/",this._parentNode=this._selectedNode,i=0;i<this._treeObj.getSelectedNode().find(".e-text").length;i++)this._treeObj.getSelectedNode().find(".e-text")[i].text==r&&(this._selectedNode=n(this._treeObj.getSelectedNode().find(".e-text")[i].parentNode.parentNode).find("a")[0]);this._toolBarItems&&this._disableToolbarItem("Download")}else this._toolBarItems&&this._enableToolbarItem("Download");if(this._currntNode=n(t.currentTarget),this._selectedContent=r,u=this._fileExplorer[this.model.path],u)for(i=0;i<u.length;i++)u[i].name==r&&(this._sizeInByte+=u[i].sizeInByte);this._selectedItems[this._selectedItems.length]=this._selectedContent;this._selectedItemsTag.html((this._selectedItems.length>1?this._selectedItems.length+" items Selected ":r)+",  "+this._bytesToSize(this._sizeInByte));this._nodeType=e;fileUrl=this._getFileURL();f={name:this._selectedContent,itemType:this._nodeType,path:fileUrl};this._urlTag&&this._urlTag.find("input").val(f.url);this._nameTag&&this._nameTag.find("input").val(f.name);this._trigger("select",f);this._enableEditingTools()},_getFileURL:function(){return this._nodeType=="File"?(/\.(gif|jpg|jpeg|tiff|png|bmp)$/i.test(this._selectedContent)?(this._widthTag&&this._widthTag.show().removeClass("e-hide"),this._heightTag&&this._heightTag.show().removeClass("e-hide")):(this._widthTag&&this._widthTag.hide().addClass("e-hide"),this._heightTag&&this._heightTag.hide().addClass("e-hide")),this.model.path.replace("~","..")+this._selectedContent):""},_updateData:function(){var n=this._fileExplorer[this.model.path],t=0,i;if(n)for(i=0;i<n.length;i++)t+=n[i].sizeInByte;t=this._bytesToSize(t);n&&!this._update?(this._itemStatus.html(n.length+(n.length==1?" item":" items")+", "+this._getLocalizedLabels("Size")+": "+t),this.model.showLayout&&this.model.layout=="grid"?this._renderGridView(n):this._renderTileView(n)):this._read()},_addChild:function(n){var r=[],t,i;if(n)for(t=0;t<n.length;t++)n[t].type=="Directory"&&(n[t].id=n[t].name,n[t].spriteCssClass="e-tree-foldericon",r.push(n[t]));this._nodeExpanded=!0;i=this._treeObj.getSelectedNode();r.length&&this._treeObj.addNode(r,i);i.find(".e-load")&&i.find(".e-load").removeClass("e-load");this._nodeExpanded=!1},_createContextMenuTag:function(i,r,u){var e=n("body").find("#"+r.id+"ContextMenu"),f=e.length?e:t.buildTag("ul.fe-context-menu #"+r.id+"ContextMenu");return f.ejMenu({menuType:t.MenuType.ContextMenu,enableSeparator:!0,enableRTL:this.model.enableRTL,contextMenuTarget:r.targetId,beforeOpen:u.beforeOpen,click:u.click,fields:{dataSource:i,id:"text",text:"text",htmlAttribute:"htmlAttr",spriteCssClass:"sprite"}}),f.hide(),f},_beforeOpenContextMenu:function(t){n(t.target).hasClass("e-text")?(this._selectedNode=t.target,n(t.target).parents("li.e-item:first").attr("id")==1?(this._treeContextMenutag.ejMenu("disableItem",this._menuDelete),this._treeContextMenutag.ejMenu("disableItem",this._menuRename)):(this._treeContextMenutag.ejMenu("enableItem",this._menuDelete),this._treeContextMenutag.ejMenu("enableItem",this._menuRename))):t.cancel=!0},_beforeOpenTileContextMenu:function(t){n(t.target).hasClass("e-scrollbar")||n(t.target).parents().hasClass("e-scrollbar")?t.cancel=!0:n(t.target).is(".e-tilenode.e-active")||n(t.target).parent(".e-tilenode").hasClass("e-active")||n(t.target).is(".e-rowcell.e-active")?(this._tileContextMenutag.ejMenu("enableItem",this._menuOpen),this._tileContextMenutag.ejMenu("enableItem",this._menuDownload),this._tileContextMenutag.ejMenu("enableItem",this._menuCut),this._tileContextMenutag.ejMenu("enableItem",this._menuCopy),this._tileContextMenutag.ejMenu("enableItem",this._menuDelete),this._tileContextMenutag.ejMenu("enableItem",this._menuRename)):(this._tileContextMenutag.ejMenu("disableItem",this._menuOpen),this._tileContextMenutag.ejMenu("disableItem",this._menuDownload),this._tileContextMenutag.ejMenu("disableItem",this._menuCut),this._tileContextMenutag.ejMenu("disableItem",this._menuCopy),this._tileContextMenutag.ejMenu("disableItem",this._menuDelete),this._tileContextMenutag.ejMenu("disableItem",this._menuRename),n(t.events.currentTarget).hasClass("e-grid")&&(n(t.target).hasClass("e-gridcontent")||n(t.target).hasClass("e-content")||n(t.target).hasClass("e-table")||!n(t.target).is(".e-rowcell.e-active"))&&this._gridObj.clearSelection(),n(t.events.currentTarget).hasClass("e-tile-wrapper")&&(n(t.target).hasClass("e-tile-wrapper")||n(t.target).hasClass("e-tile-content")||n(t.target).hasClass("e-tileview")||!(n(t.target).is(".e-tilenode.e-active")||n(t.target).parent(".e-tilenode").hasClass("e-active")))&&this.items.hasClass("e-active")&&this.items.removeClass("e-active"),this._removeOldSelectionDetails())},_removeOldSelectionDetails:function(){this.model.path!=this._originalPath&&(this.model.path=this._originalPath,this._selectedNode=this._parentNode);this._selectedItems=[];this._selectedContent=n(this._selectedNode).text();this._nodeType="Directory";this._selectedItemsTag.html("");this._toolBarItems&&this._disableToolbarItem("Download");this._disableEditingTools()},_contextMenuClick:function(n){this._treeObj.selectNode(this._selectedNode);this._fileContextMenuClick(n)},_fileContextMenuClick:function(n){switch(n.events.text){case this._menuOpen:this._openAction();break;case this._menuNewFolder:this._createNewFolder();break;case this._menuDelete:this._deleteFolder();break;case this._menuRename:this._renameFolder();break;case this._menuUpload:this.element.find(".e-uploadinput").click();break;case this._menuDownload:this._downloadFile();break;case this._menuCut:this._copyMoveNode("move");break;case this._menuCopy:this._copyMoveNode("copy");break;case this._menuPaste:this._nodeType=="Directory"&&this._cut_copy();break;case this._menuGetinfo:this._getDetails()}},_createNewFolder:function(){var i=this,u="",h=this._getLocalizedLabels("NewFolderAlert"),f=t.buildTag("div.e-get-name"),c=t.buildTag("div.e-fe-dialog-label",h),r=t.buildTag("input.e-fe-dialog-text","","",{type:"text"});r.val("NewFolder");var e=t.buildTag("div.e-fe-dialog-btn"),o=t.buildTag("button.e-fe-btn-ok ",this._getLocalizedLabels("OkButton")),s=t.buildTag("button.e-fe-btn-cancel ",this._getLocalizedLabels("CancelButton"));o.ejButton({click:function(){var n=i._newFolderDialog.data("ejDialog")._overLay;n&&n.remove();i._newFolderDialog.parents(".e-dialog").remove();u=r.val();u&&i._createFolder(u)}});s.ejButton({click:function(){var n=i._newFolderDialog.data("ejDialog")._overLay;n&&n.remove();i._newFolderDialog.parents(".e-dialog").remove()}});e.append(o,s);n(f).append(c,r,e);create=function(){r.focus();r.select()};this._newFolderDialog=this._createDialog(f,{width:318,height:140,create:create})},_deleteFolder:function(){this._ajax_folderPath=this._nodeType=="Directory"?this._getFolderPath():this.model.path;this._deletion(this._selectedItems.length>1?this._selectedItems:this._selectedContent,this._ajax_folderPath);this._disableEditingTools()},_renameFolder:function(){var i=this,s=this._getLocalizedLabels("RenameAlert"),u=t.buildTag("div.e-rename"),h=t.buildTag("div.e-fe-dialog-label",s),r=t.buildTag("input.e-fe-dialog-text","","",{type:"text",value:this._selectedContent.split(".")[0]}),f=t.buildTag("div.e-fe-dialog-btn"),e=t.buildTag("button.e-fe-btn-ok",this._getLocalizedLabels("OkButton")),o=t.buildTag("button.e-fe-btn-cancel",this._getLocalizedLabels("CancelButton"));e.ejButton({click:function(){var n=r.val(),t,u;n&&(t=i._selectedContent.split(".")[1],n=t?n+"."+t:n,i._ajax_person=n,folderPath=i._nodeType=="Directory"?i._getFolderPath():i.model.path,i.model.path=folderPath,i._rename(folderPath,i._selectedContent,n,i._nodeType),u=i._renameDialog.data("ejDialog")._overLay,u&&u.remove(),i._renameDialog.parents(".e-dialog").remove())}});o.ejButton({click:function(){var n=i._renameDialog.data("ejDialog")._overLay;n&&n.remove();i._renameDialog.parents(".e-dialog").remove()}});f.append(e,o);n(u).append(h,r,f);create=function(){r.focus();r.select()};this._renameDialog=this._createDialog(u,{width:318,height:140,create:create})},_refreshItems:function(t,i){var u,r;if(this._nodeType=="Directory"){for(this._fileExplorer[i]="",u=n(t).parents("li.e-item:first").find("a"),r=1;r<u.length;r++)n(t).parents("li.e-item:first").find(u[r]).length&&this._treeObj.removeNode(u[r]);this._update=!0;this._treeObj.selectNode(t);this._addChild(this._fileExplorer[this.model.path])}},_backward:function(){if(this._currentState>0)this._isStateNavigation=!0,this._treetag.find(this._selectedStates[--this._currentState]).length?this._treeObj.selectNode(this._selectedStates[this._currentState]):this._backward(),this._isStateNavigation=!1,this._selectedStates.length-2==this._currentState&&this._toolBarItems&&this._enableToolbarItem("Forward"),this._currentState==0&&this._toolBarItems&&this._disableToolbarItem("Back")},_forward:function(){if(this._currentState+1<this._selectedStates.length)this._isStateNavigation=!0,this._treetag.find(this._selectedStates[++this._currentState]).length?this._treeObj.selectNode(this._selectedStates[this._currentState]):this._forward(),this._isStateNavigation=!1,this._selectedStates.length-1==this._currentState&&this._toolBarItems&&this._disableToolbarItem("Forward"),this._currentState==0&&this._toolBarItems&&this._disableToolbarItem("Back"),this._currentState==1&&this._toolBarItems&&this._enableToolbarItem("Back")},_copyMoveNode:function(n){n=="move"&&(this.element.find(".e-blur").removeClass("e-blur"),this._currntNode.hasClass("e-active")&&this._currntNode.addClass("e-blur"),this._currntNode.find(".e-active").length&&this._currntNode.find(".e-active").addClass("e-blur"));this._option=n;this._soucePath=this.model.path;this._sourceType=this._nodeType;this._fileName=this._selectedContent;this._refreshNode=this._selectedNode;this._toolBarItems&&this._enableToolbarItem("Paste")},_openAction:function(){var i=this,r,e,u,f,o,s,h;if(this._nodeType=="Directory")for(r=this._treeObj.getSelectedNode(),this._treeObj.hasChildNode(r)||(e=this._isTreeNode==!0?this.model.path:this.model.path.replace(this._selectedContent+"/",""),this._isTreeNode=!1,this._addChild(this._fileExplorer[e])),u=0;u<r.find(".e-text").length;u++)r.find(".e-text")[u].text==this._selectedContent&&this._treeObj.selectNode(r.find(".e-text")[u].parentNode.parentNode);else this._nodeType=="File"&&(this._selectedFile=this._selectedContent,i._openDialog=t.buildTag("div.e-imageViewer","","",{id:i._ExplorerId+"_basicDialog",title:i._selectedFile}),f=i.model.path.replace("~","..")+this._selectedFile,o=t.buildTag("img","","",{src:f}),n(i._openDialog).append(o),n(i.element).append(i._openDialog),i._openDialog.ejDialog({width:450,height:350,enableRTL:i.model.enableRTL,cssClass:i.model.cssClass,close:function(n){i._onDialogClose(n)}}));s=this._nodeType=="File"?f:this.model.path;h={path:s,itemType:this._nodeType};this._trigger("open",h)},_getDetails:function(){var f=this._nodeType=="Directory"?this._getFolderPath():this.model.path,r=this,u={data:{ActionType:"GetDetails",Path:f,Name:this._selectedContent,Type:this._nodeType},url:this.model.ajaxAction,type:"POST",async:!1,success:function(i){var u=t.buildTag("div.e-fe-table"),f=t.buildTag("table");n.each(i,function(i,r){var u=t.buildTag("tr"),e=t.buildTag("td",i),o=t.buildTag("td",r);n(f).append(u);n(u).append(e,o)});n(u).append(f);r._detailsDialog=r._createDialog(u,{width:500,height:300})}};this.model.ajaxSettings.getDetais.success=i;n.extend(!0,u,this.model.ajaxSettings.getDetais);this._sendAjaxRequest(u,!0)},_uploadFile:function(){proxy=this.element.find(".e-uploadbox");proxy=proxy.ejUploadbox("instance")},_getFolderPath:function(){for(var t=this.model.path.split("/"),i="",n=0;n<t.length-2;n++)i+=t[n]+"/";return i},_renderToolBar:function(){this._crateToolbarTemplate();this._initToolbarItems();var t={};t.click=n.proxy(this._toolBarClick,this);t.cssClass=this.model.cssClass;t.enableRTL=this.model.enableRTL;t.enableSeparator=this.model.isResponsive?!0:!1;t.isResponsive=this.model.isResponsive;t.height=t.isResponsive?"36px":"auto";t.cssClass=this.model.cssClass;t.enableRTL=this.model.enableRTL;this._toolBarItems.ejToolbar(t);this._disableToolbarItem("Paste");this._disableToolbarItem("Download");this._disableToolbarItem("Back");this._disableToolbarItem("Forward");this._disableEditingTools();this._toolBarItems.css("display","block")},_initToolbarItems:function(){this._toolBarItems.find("#"+this._ExplorerId+"Addressbar").length>0&&this._createAddressBar();this._toolBarItems.find("#"+this._ExplorerId+"Searchbar").length>0&&this._searchDetails()},_createUploadBox:function(){this._uploadtag=t.buildTag("div#FileUpload","",{padding:"0px",height:"0px",width:"0px"});this.element.prepend(this._uploadtag);this._renderUploadBox();this._uploadtag.find(".e-inputbtn").hide()},_searchDetails:function(){this._searchbar=t.buildTag("input.e-searchBar e-tool-input","",{},{id:this._ExplorerId+"_searchbar",type:"text",placeholder:this._getLocalizedLabels("Search")});this._searchbar.appendTo(this._toolBarItems.find("#"+this._ExplorerId+"Searchbar").html(""))},_getLocalizedLabels:function(n){return t.FileExplorer.Locale[this.model.locale][n]===i?t.FileExplorer.Locale["en-US"][n]:t.FileExplorer.Locale[this.model.locale][n]},_crateToolbarTemplate:function(){this._toolBarItems=t.buildTag("div#"+this._ExplorerId+"_toolbar").prependTo(this.element);for(var n=0;n<this.model.toolsList.length;n++)items=this.model.toolsList[n],t.isNullOrUndefined(this.model.tools[items])||(items=="customTool"?t.isNullOrUndefined(this.model.tools[items])||this._customTools(this.model.tools[items]):this.model.tools[items].length>0&&this._createToolsItems(this.model.tools[items],items))},_createToolsItems:function(i,r){var f=t.buildTag("ul#"+(this._ExplorerId+r)),e,u;for(f.addClass("e-ul-"+r),u=0;u<i.length;u++)e=n("<li id='"+(this._ExplorerId+i[u].replace(/ /g,""))+"' class='e-feItem-"+i[u]+"' title='"+this._getLocalizedLabels(i[u].replace(/ /g,""))+"' ><div class='e-fileexplorer-toolbar-icon "+i[u]+"'><\/div><\/li>"),e.appendTo(f);f.appendTo(this._toolBarItems)},_customTools:function(i){for(var e,f,u,r=0;r<i.length;r++)e=t.buildTag("ul"),f=n("<li id='"+i[r].name+"' title='"+i[r].tooltip+"' ><div class='"+(t.isNullOrUndefined(i[r].css)?"":i[r].css)+"'><\/div><\/li>"),u=i[r].action,typeof u=="string"&&(u=t.util.getObject(u,window)),t.isNullOrUndefined(i[r].action)||this._on(f,"click",u),n(i[r].template).appendTo(f.find("div")),f.appendTo(e),e.appendTo(this._toolBarItems)},_toolBarClick:function(n){var t=n.currentTarget.id;switch(t){case this._ExplorerId+"Addressbar":n.currentTarget.focus();break;case this._ExplorerId+"Download":this._downloadFile();break;case this._ExplorerId+"NewFolder":this._createNewFolder();break;case this._ExplorerId+"Delete":this._deleteFolder();break;case this._ExplorerId+"Rename":this._renameFolder();break;case this._ExplorerId+"Refresh":this._refreshItems(this._selectedNode,this.model.path);break;case this._ExplorerId+"Back":this._backward();break;case this._ExplorerId+"Forward":this._forward();break;case this._ExplorerId+"Cut":this._copyMoveNode("move");break;case this._ExplorerId+"Copy":this._copyMoveNode("copy");break;case this._ExplorerId+"Paste":this._nodeType=="Directory"&&this._cut_copy();break;case this._ExplorerId+"Open":this._openAction();break;case this._ExplorerId+"Details":this._getDetails();break;case this._ExplorerId+"Upload":this.element.find(".e-uploadinput").click()}},_getFilteredList:function(n){if(!n||!n.length||n.length<1)this.suggestionListItems=[];else{var i=t.Query();this._addQuery(i,typeof n[0]=="object");this.suggestionListItems=t.DataManager(n).executeLocal(i)}this.model.layout=="grid"?this._renderGridView(this.suggestionListItems):this._renderTileView(this.suggestionListItems)},_addQuery:function(n,t){var i="";t&&(i="name");this._queryString&&n.where(i,this.model.filterSettings.filterType,this._queryString,!this.model.filterSettings.caseSensitiveSearch)},_validateKeyCode:function(n){switch(n.which){case 38:case 40:case 37:case 39:case 20:case 16:case 17:case 18:case 35:case 36:case 144:case 27:break;case 9:case 46:case 8:case 13:default:this._queryString=n.currentTarget.value;var t=this._addresstag.val();this.model.path=this.model.path.split(t)[0]+t;this._getFilteredList(this._fileExplorer[this.model.path])}},_onDialogClose:function(){n("body").find("#"+this._ExplorerId+"_basicDialog_wrapper").remove()},_switchView:function(n){if(changed=!1,this.model.path=this._originalPath,n.currentTarget.getAttribute("id")==this._ExplorerId+"_swithListView"?(this._gridtag.hide(),this._tileContent.parent().show(),this.model.layout!="tile"&&(this._renderTileView(this._fileExplorer[this.model.path]),changed=!0),this.model.layout="tile",this._statusbar&&(this._statusbar.find(".e-swithListView-icon").addClass("e-active-color"),this._statusbar.find(".e-switchGridView-icon").removeClass("e-active-color"))):(this._tileView&&this._tileContent.parent().hide(),this._gridtag.show(),this.model.layout!="grid"&&(this.model.layout="grid",this._renderGridView(this._fileExplorer[this.model.path]),changed=!0),this._statusbar&&(this._statusbar.find(".e-swithListView-icon").removeClass("e-active-color"),this._statusbar.find(".e-switchGridView-icon").addClass("e-active-color"))),changed){this._searchbar&&this._searchbar.val("");var t={layoutType:this.model.layout};this._trigger("layoutChange",t)}},_wireEvents:function(){this._on(n("#"+this._ExplorerId+"_newFolder"),"click",this._createNewFolder);this._on(n("#"+this._ExplorerId+"_switchGridView"),"click",this._switchView);this._on(n("#"+this._ExplorerId+"_swithListView"),"click",this._switchView);this._on(n("#"+this._ExplorerId+"_addressbar"),"keypress",this._searchPath);this._on(n("#"+this._ExplorerId+"_searchbar"),"keyup",this._validateKeyCode);this._on(this.element,"keydown",this._keyDownOnInput);this._on(this._gridtag,"click",this._gridtagClick);this._on(this._tileViewWrapper,"click",this._tileViewWrapperClick)},_closeDialog:function(t){this._unwireDialogEvent(t);n(t.target).closest("div.e-dialog").find(".e-dialog").ejDialog("close")},_searchPath:function(i){var f,r,u;if(i.which===13)for(this._searchbar.val(""),f=this._addresstag.val().split("/"),r=this._treetag,u=0;u<f.length;u++)f[u]&&(r=this._findMatchingElement(n(r).children("ul"),f[u]),r.length?this._treetag.ejTreeView("selectNode",r):this._alertDialog=this._createDialog(t.buildTag("div.e-fe-dialog-label e-fe-center",this._getLocalizedLabels("ErrorPath")),{width:400,height:100}))},_createDialog:function(i,r){var f=this,u=t.buildTag("div#"+this._ExplorerId+"_basicDialog.e-fe-dialog");return n(u).append(i),u.ejDialog({width:r.width,height:r.height,enableModal:!0,showHeader:!0,enableResize:!1,enableRTL:this.model.enableRTL,cssClass:this.model.cssClass+" e-fe-dialog",create:r.create,close:function(n){f._onDialogClose(n)}}),u},_findMatchingElement:function(t,i){return n(t).children("li").filter(function(){if(n(this).find(".e-text:first").text()==i)return n(this)})},_keyDownOnInput:function(t){switch(t.keyCode){case 84:t.shiftKey&&(t.preventDefault(),this._addFocus(this._toolBarItems));break;case 65:t.shiftKey&&(t.preventDefault(),this._addFocus(this._actionbar));break;case 78:t.shiftKey&&(t.preventDefault(),this._addFocus(this._treetag));break;case 71:t.shiftKey&&(t.preventDefault(),this._addFocus(this._gridtag));break;case 76:t.shiftKey&&(t.preventDefault(),this._addFocus(this._tileView));break;case 83:t.shiftKey&&(t.preventDefault(),this._addFocus(n(this._splittag.find(".e-splitbar")[0])));break;case 73:t.shiftKey&&(t.preventDefault(),this._addFocus(this._statusbar))}},_getFocusedElement:function(){var t=this.element.find(".e-focus");return t=t?t:n(":focus"),t.length?t:this.element.find(".e-active")},_addFocus:function(t){if(!t.hasClass("e-focus"))if(this._removeFocus(),t.addClass("e-focus"),t.focus(),t.hasClass("e-tileview"))this._itemList=this.items,n(document).bind("keydown",n.proxy(this._OnKeyDown,this)),n(document).bind("keyup",n.proxy(this._OnKeyUp,this));else if(t.hasClass("e-actionbar"))this._itemList=this._actionbar.find("button"),n(document).bind("keydown",n.proxy(this._OnKeyDown,this)),n(document).bind("keyup",n.proxy(this._OnKeyUp,this));else if(t.hasClass("e-statusbar"))this._itemList=this._insertFileOption.find(".e-keyNav"),n(document).bind("keydown",n.proxy(this._OnKeyDown,this)),n(document).bind("keyup",n.proxy(this._OnKeyUp,this));else if(t.hasClass("e-grid"))n(document).bind("keyup",n.proxy(this._OnKeyUp,this));else if(t.hasClass("e-treeview")){var i=this._treetag.ejTreeView("instance");i._on(this._treetag,"keydown",i._KeyPress)}},_removeFocus:function(){var t=this._getFocusedElement(),i;t.length>0&&(t.removeClass("e-focus"),t.hasClass("e-tileview")?(n(document).unbind("keydown",n.proxy(this._OnKeyDown,this)),n(document).unbind("keyup",n.proxy(this._OnKeyUp,this))):t.hasClass("e-actionbar")?(n(document).unbind("keydown",n.proxy(this._OnKeyDown,this)),n(document).unbind("keyup",n.proxy(this._OnKeyUp,this))):t.hasClass("e-statusbar")?(n(document).unbind("keydown",n.proxy(this._OnKeyDown,this)),n(document).unbind("keyup",n.proxy(this._OnKeyUp,this))):t.hasClass("e-grid")?n(document).unbind("keyup",n.proxy(this._OnKeyUp,this)):t.parents(".e-treeview")&&(i=this._treetag.ejTreeView("instance"),i._off(this._treetag,"keydown")),t.blur())},_subControlsSetModel:function(n,i){t.isNullOrUndefined(this._treetag)||this._treetag.data("ejTreeView").option(n,i);this._downloadDialog&&this._downloadDialog.data("ejDialog").option(n,i);this._newFolderDialog&&this._newFolderDialog.data("ejDialog").option(n,i);this._renameDialog&&this._renameDialog.data("ejDialog").option(n,i);this._openDialog&&this._openDialog.data("ejDialog").option(n,i);this._detailsDialog&&this._detailsDialog.data("ejDialog").option(n,i);this._alertDialog&&this._alertDialog.data("ejDialog").option(n,i);this._treeContextMenutag&&this._treeContextMenutag.data("ejMenu").option(n,i);this._tileContextMenutag&&this._tileContextMenutag.data("ejMenu").option(n,i);this._toolBarItems&&this._toolBarItems.data("ejToolbar").option(n,i)},_reSizeHandler:function(){if(this.model.layout=="grid"){var n=this._splittag.height()-this._gridtag.find(".e-gridheader").outerHeight();this._gridtag.ejGrid({scrollSettings:{height:this.model.showFooter?n-this._statusbar.height()-1:n,width:this._splittag.find(".e-cont2").width()}});this._gridtag.find(".e-gridcontent").hasClass("e-scroller")&&this._gridtag.find(".e-gridcontent").ejScroller({buttonSize:0,scrollerSize:this._scrollerSize})}else this._tileContent.parent(".e-tile-wrapper").ejScroller("refresh");this._treetag.parent(".e-tree-wrapper").ejScroller({width:this._splittag.find(".e-cont1").width()})},_unwireEvents:function(){this._off(n("#"+this._ExplorerId+"_newFolder"),"click",this._createNewFolder);this._off(n("#"+this._ExplorerId+"_switchGridView"),"click",this._switchView);this._off(n("#"+this._ExplorerId+"_swithListView"),"click",this._switchView);this._off(n("#"+this._ExplorerId+"_addressbar"),"keypress",this._searchPath);this._off(n("#"+this._ExplorerId+"_searchbar"),"keyup",this._validateKeyCode);this._off(this.element,"keydown",this._keyDownOnInput);this._off(this._gridtag,"click");this._off(this._tileViewWrapper,"click")},_wireResizing:function(){this.model.isResponsive?n(window).bind("resize",n.proxy(this._reSizeHandler,this)):n(window).unbind("resize",n.proxy(this._reSizeHandler,this))}});t.FileExplorer.Locale={};t.FileExplorer.Locale["en-US"]={Back:"Backward",Forward:"Forward",Refresh:"Refresh",Addressbar:"Address bar",Upload:"Upload File",Rename:"Rename",Delete:"Delete",Download:"Download File",Cut:"Cut",Copy:"Copy",Paste:"Paste",Details:"Get Details",Searchbar:"Search bar",Open:"Open",Search:"Search",NewFolder:"Add Folder",Size:"Size",RenameAlert:"Please enter new name",NewFolderAlert:"Please enter new folder name",DownloadTitle:"Confirmation..!",DownloadAlert:"Are you sure want to download",DownloadConfirmation:"Ok, Download",ContextMenuOpen:"Open",ContextMenuNewFolder:"New Folder",ContextMenuDelete:"Delete",ContextMenuRename:"Rename",ContextMenuUpload:"Upload",ContextMenuDownload:"Download",ContextMenuCut:"Cut",ContextMenuCopy:"Copy",ContextMenuPaste:"Paste",ContextMenuGetinfo:"Get info",Item:"item",Items:"items",ErrorOnFolderCreation:"Folder name already exist in directory, please give new name",GeneralError:"Please see browser console window for more information",ErrorPath:"Invalid Path cannot access further folder",OkButton:"Ok",CancelButton:"Cancel",YesButton:"Yes",NoButton:"No",Grid:"Grid View",Tile:"Tile View"};t.FileExplorer.filterType={StartsWith:"startswith",Contains:"contains",EndsWith:"endswith",LessThan:"lessthan",GreaterThan:"greaterthan",LessThanOrEqual:"lessthanorequal",GreaterThanOrEqual:"greaterthanorequal",Equal:"equal",NotEqual:"notequal"};t.FileExplorer.layoutType={Tile:"tile",Grid:"grid"}})(jQuery,Syncfusion)})