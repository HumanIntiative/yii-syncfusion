/*!
*  filename: ej.maskedit.min.js
*  version : 13.1.0.21
*  Copyright Syncfusion Inc. 2001 - 2015. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min"],n):n()})(function(){(function(n,t,i){t.widget("ejMaskEdit","ej.MaskEdit",{element:null,model:null,validTags:["input"],_setFirst:!1,type:"editor",defaults:{maskFormat:"",value:"",watermarkText:"",height:"",width:"",showError:!1,htmlAttributes:{},cssClass:"",customCharacter:null,inputMode:"text",readOnly:!1,textAlign:t.TextAlign.Left,hidePromptOnLeave:!1,showRoundedCorner:!1,enablePersistence:!1,enabled:!0,validationRules:null,validationMessage:null,keydown:null,keyup:null,keyPress:null,change:null,mouseover:null,mouseout:null,focusIn:null,focusOut:null,create:null,destroy:null},dataTypes:{maskFormat:"string",showError:"boolean",enabled:"boolean",customCharacter:"string",cssClass:"string",watermarkText:"string",showRoundedCorner:"boolean",inputMode:"enum",textAlign:"enum",hidePromptOnLeave:"boolean",readOnly:"boolean",validationRules:"data",validationMessage:"data",htmlAttributes:"data"},_setModel:function(n){for(var t in n)switch(t){case"value":this._setValue(n[t]);n[t]=this.get_UnstrippedValue();break;case"width":this._setWidth(n[t]);break;case"height":this._setHeight(n[t]);break;case"watermarkText":this.model.watermarkText=n[t];this._changeWatermark(n[t]);break;case"showRoundedCorner":this._roundedCorner(n[t]);break;case"validationRules":this.model.validationRules!=null&&(this._hiddenInput.rules("remove"),this.model.validationMessage=null);this.model.validationRules=n[t];this._setValidation();break;case"validationMessage":this.model.validationMessage=n[t];this._setValidation();break;case"textAlign":this._setTextAlign(n[t]);break;case"inputMode":this._setInputMode(n[t]);break;case"maskFormat":this._setMask(n[t]);break;case"cssClass":this._setSkin(n[t]);break;case"readOnly":this._setReadOnly(n[t]);break;case"enabled":this.model.enabled=n[t];this._controlStatus(n[t]);break;case"htmlAttributes":this._addAttr(n[t])}},observables:["value"],_destroy:function(){this.element.attr("name",this._hiddenInput.attr("name"));this._isWatermark&&this.element.removeAttr("placeholder");this.element.insertAfter(this.wrapper);this.wrapper.remove();this.model.textAlign&&this.element.css("text-align","");this.element.val("").removeClass(" e-mask e-input e-corner-all e-disable").empty()},_init:function(){if(this.element.is("input")&&(this.element.is("input[type=text]")||this.element.is("input[type=password]")||!this.element.attr("type")))this._isWatermark="placeholder"in document.createElement("input"),this._setValues(),this._renderControl(),this._initObjects(),this._wireEvents(),this._addAttr(this.model.htmlAttributes),this.model.validationRules!=null&&(this._initValidator(),this._setValidation());else return this._destroy(),!1},_initValidator:function(){var t=this;this.element.closest("form").validate({ignore:".e-hidden",errorClass:"e-validation-error",errorElement:"span",errorPlacement:function(t,i){n(t).insertAfter(i.closest(".e-widget"))}})},_addAttr:function(t){var i=this;n.map(t,function(n,t){t=="class"?i.wrapper.addClass(n):t=="style"?i.wrapper.attr(t,n):i.element.attr(t,n);t=="disabled"&&n=="disabled"&&i.disable();t=="readOnly"&&n=="readOnly"&&i._setReadOnly(!0)})},_setValidation:function(){var u,i,r,f;this._hiddenInput.rules("add",this.model.validationRules);u=this.element.closest("form").validate();name=this._hiddenInput.attr("name");u.settings.messages[name]={};for(i in this.model.validationRules)if(r=null,!t.isNullOrUndefined(this.model.validationRules[i])){if(t.isNullOrUndefined(this.model.validationRules.messages&&this.model.validationRules.messages[i])){u.settings.messages[name][i]=n.validator.messages[i];for(f in this.model.validationMessage)i==f?r=this.model.validationMessage[i]:""}else r=this.model.validationRules.messages[i];u.settings.messages[name][i]=r!=null?r:n.validator.messages[i]}},_controlStatus:function(n){n!=!0?this.disable():this.enable()},_setValues:function(){this._tempMask=null;this._unStrippedMask=null;this._charMap={"9":"[0-9 ]",a:"[A-Za-z0-9 ]",A:"[A-Za-z0-9]",N:"[0-9]","<":"",">":"",C:"[A-Za-z ]","?":"[A-Za-z]"}},_renderControl:function(){this.model.name=this.element.attr("name")!=null?this.element.attr("name"):this.model.name!=null?this.model.name:this.element[0].id;this.element.attr("name")!=null&&this.element.removeAttr("name");this.wrapper=t.buildTag("span.e-mask e-widget "+this.model.cssClass);this.innerWrapper=t.buildTag("span.e-in-wrap e-box");this.wrapper.append(this.innerWrapper).insertBefore(this.element);this.innerWrapper.append(this.element);this._hiddenInput=t.buildTag("input#"+this._id+"_hidden","",{},{type:"hidden"}).insertBefore(this.element);this._isWatermark||this.model.inputMode=="password"||(this._hiddenSpan=t.buildTag("span.e-input e-placeholder ").insertAfter(this.element),this._hiddenSpan.text(this.model.watermarkText),this._hiddenSpan.css("display","none"),this._hiddenSpan.bind("mousedown",n.proxy(this._OnFocusHandler,this)));this._hiddenInput.attr("name",this.model.name);this.model.value=this.model.value===""?this.element[0].value:this.model.value;this.element.attr({"aria-invalid":!1,value:this.model.value}).addClass("e-input");this.element.attr("type")?this.model.inputMode=this.element.attr("type"):this._setInputMode(this.model.inputMode);this._setWidth(this.model.width);this._setHeight(this.model.height);this._roundedCorner(this.model.showRoundedCorner);this._setTextAlign(this.model.textAlign);this._setReadOnly(this.model.readOnly);this._controlStatus(this.model.enabled);this.previousValue=this.model.value},_initObjects:function(){this._textbox=this.element[0];this._keypressFlag=0;this._selectedTextKeyDown=0;this._keydownFlag=0;this._maskLength=this.model.maskFormat.length;this._maskModel=this.model.maskFormat.replace(/[9?CANa]/g,"_");this._validatedValue=this._maskModel;this.model.inputMode!="password"&&(this._setValue(this.model.value),this._setWaterMark());this.model.showError&&this.element.addClass("e-error").attr("aria-invalid","true")},_setWidth:function(n){this.wrapper.width(n)},_setHeight:function(n){this.wrapper.height(n)},_roundedCorner:function(n){n?this.wrapper.removeClass("e-corner-all").addClass("e-corner-all"):this.wrapper.hasClass("e-corner-all")&&this.wrapper.removeClass("e-corner-all")},_setTextAlign:function(n){n=="right"?this.wrapper.addClass("e-rtl"):this.wrapper.removeClass("e-rtl")},_setInputMode:function(n){this.element.attr("type",n)},_setReadOnly:function(n){this.model.readOnly=n;n?this.element.attr("readonly",!0):this.element.removeAttr("readonly")},_setSkin:function(n){this.wrapper.removeClass(this.model.cssClass);this.wrapper.addClass(n)},_setWaterMark:function(){this._maskModel=this.model.maskFormat.replace(/[9?CANa]/g,"_");this.model.watermarkText&&(this._maskModel!=""&&this._textbox.value==this._maskModel||this._maskModel==""&&this._textbox.value=="")&&this.model.inputMode!="password"&&(this._textbox.value="",this._isWatermark?this.element.attr("placeholder",this.model.watermarkText):this._hiddenSpan.css("display","block").text(this.model.watermarkText))},_changeWatermark:function(n){if(!this.model.enabled)return!1;this.model.inputMode!="password"&&(this._isWatermark?this.element.attr("placeholder",n):this._hiddenSpan.text(n))},_showAlert:function(){var t=this;this.element.addClass("e-error").attr("aria-invalid","true").animate({Opacity:1},700,null,function(){n(t._textbox).removeClass("e-error").attr("aria-invalid","false")})},_validateValue:function(){var t=this.model.value,i=this._maskModel,r=-1,f,n,e,o,u;if(this._isWatermark||this.model.inputMode=="password"||this._hiddenSpan.css("display","none"),this._maskLength==0)return this._textbox.value=t,this._setWaterMark(),!0;for(f=this.model.value.toString(),t=this.model.value=f.replace(/[\(\)-]/g,""),n=0;n<this._maskLength;n++)this._charMap[this.model.maskFormat.charAt(n)]!=null&&(r++,e=t.charCodeAt(r),this._validateChars(e,n)&&(o=i.substring(0,n),u=i.substring(n),i=o+t.charAt(r)+u.substr(1,u.length)));this._textbox.value=this.model.value?i:this.model.maskFormat.replace(/[9?CANa]/g,"_");this._setWaterMark()},_selectionText:function(n,t){var i=this._maskModel.substring(n,t);return(this._textbox.value=this._textbox.value.substring(0,n)+i+this._textbox.value.substring(t),this._keydownFlag==1)?(this._setCaretPosition(n),n):this._keydownFlag==2?(this._setCaretPosition(t),t):n},_caretPosition:function(n){var t=0,i,r;return document.selection?(i=document.selection.createRange(),r=i.text.length,i.moveStart("character",-n.value.length),t=i.text.length-r,r!=0&&(t=this._selectionText(t,i.text.length),this._selectedTextKeyDown=1)):(n.selectionStart||n.selectionStart=="0")&&(t=n.selectionStart,n.selectionStart!=n.selectionEnd&&(this._keydownFlag&&(t=this._selectionText(n.selectionStart,n.selectionEnd)),this._selectedTextKeyDown=1)),t},_setCaretPosition:function(n){var t=this._textbox,i;window.navigator.appName=="Microsoft Internet Explorer"?t.createTextRange&&(i=t.createTextRange(),i.move("character",n),i.select()):t.selectionStart||t.selectionStart=="0"?(t.focus(),t.setSelectionRange(n,n)):t.focus()},_validateChars:function(t,i){var f=this._charMap,r=!1,e=this.model.maskFormat.substr(i,1),u=this.model.customCharacter,o=String.fromCharCode(t);return n.each(f,function(n,t){e==n&&(u!=null&&(n=="C"?t="["+u+"]":(n=="A"||n=="N")&&(t=t.replace("]","")+u+"]")),r=o.match(new RegExp(t))?!0:!1)}),r},_seekNext:function(){for(var n=this._caretPosition(this._textbox),t=n,i=!0;i;){if(n>=0&&n<this._maskLength&&(this.model.maskFormat.charAt(n)!="C"&&(this._charMap[this.model.maskFormat.charAt(n)]||(this._setCaretPosition(n),n++)),n!=t)){t=n;continue}i=!1}return n},_seekBefore:function(){var n=this._caretPosition(this._textbox),i=--n,t=!0;for(this._selectedTextKeyDown==1&&(t=!1);t;){if(n>=0&&n<this._maskLength&&(this.model.maskFormat.charAt(n)!="C"&&(this._charMap[this.model.maskFormat.charAt(n)]||this._setCaretPosition(--n)),n!=i)){i=n;continue}t=!1}return n},_writeBuffer:function(n,t){var r,u,e,f;t<=this._maskLength&&(r=this._textbox.value,this._tempMask!=null&&(u=this._updateCasing(n,t)),n=u==i?n:u,e=r.substring(0,t),f=r.substring(t),this._textbox.value=e+n+f.substr(1,f.length),this._setCaretPosition(t+1),this._raiseEvents("change"))},_updateCasing:function(n,t){for(var r,i=0;i<t+1;i++)(this._tempMask.substr(i,1)=="<"||this._tempMask.substr(i,1)==">")&&t++;for(r=t;r>-1;r--){if(this._tempMask.substr(r,1)=="<")return n.toLowerCase();if(this._tempMask.substr(r,1)==">")return n.toUpperCase()}},get_StrippedValue:function(){var r,u=this.model.maskFormat,f="",n,t,i;if(r=this._textbox.value==""&&this.model.inputMode!="password"?this._maskModel:this._textbox.value,u.length==0)return r;for(n=0;n<u.length;n++)t=u[n],i=null,"9?$a*".indexOf(t)!=-1?i=this._charMap[t]:t=="A"||t=="N"?i=this._charMap[t].replace("]","")+this.model.customCharacter+"]":t=="C"&&(i="["+this.model.customCharacter+"]"),i&&r[n]&&r[n].match(new RegExp(i))&&(f+=r[n]);return f},get_UnstrippedValue:function(){var n=this._textbox.value==""&&this.model.inputMode!="password"?this._maskModel:this._textbox.value,t="";return this.model.maskFormat.length==0?n:(n!=i&&(t=n.replace(/[_]/g," ")),t)},_setValue:function(n){t.isNullOrUndefined(n)&&(n="");this.previousValue=this.model.value=n;this._isWatermark||this.model.inputMode=="password"||this._hiddenSpan.css("display","none");t.isNullOrUndefined(this.model.maskFormat)||this.model.maskFormat==""?this._textbox.value=n:this._validateValue();this._setWaterMark();this._raiseEvents("change")},_setMask:function(n){this._maskLength=n.length;this.model.maskFormat=n;this._maskModel=n.replace(/[9?CANa]/g,"_");this._validateValue()},enable:function(){this.element.disabled=!1;this.element.removeAttr("disabled").removeClass("e-disable").attr({"aria-disabled":!1});this.model.enabled=!0},disable:function(){this.element.disabled=!0;this.element.attr("disabled","disabled").addClass("e-disable").attr({"aria-disabled":!0});this.model.enabled=!1},clear:function(){this._textbox.value=this.model.maskFormat.replace(/[9?aCAN]/g,"_")},_wireEvents:function(){this._on(this.element,"focus",this._OnFocusHandler);this._on(this.element,"blur",this._OnBlurHandler);this._on(this.element,"keydown",this._OnKeyDownHandler);this._on(this.element,"keypress",this._OnKeyPressHandler);this._on(this.element,"keyup",this._OnKeyUpHandler);this._on(this.element,"mouseover",this._OnMouseOverHandler);this._on(this.element,"mouseout",this._OnMouseOutHandler);this._on(this.element,"paste",this._OnPasteHandler);this._on(this.element,"cut",this._OnCutHandler)},_OnCutHandler:function(){var t=this._maskModel.substring(this._textbox.selectionStart,this._textbox.selectionEnd),i=this._textbox.value.substring(0,this._textbox.selectionStart),r=this._textbox.value.substring(this._textbox.selectionEnd),u=this._textbox.selectionStart,n=this;setTimeout(function(){n._textbox.value=i+t+r;n._setCaretPosition(u);n._raiseEvents("change")},0)},_OnPasteHandler:function(){var t=this;return setTimeout(function(){var i=n(t._textbox).val();t._setValue(i);t._raiseEvents("change")},0),!0},_OnFocusHandler:function(){(this.wrapper.addClass("e-focus"),this.model.readOnly)||(this._isWatermark||this.model.inputMode=="password"||this._hiddenSpan.css("display","none"),this._textbox.value==""&&this._maskModel!=""&&this.model.inputMode!="password"&&(this._textbox.value=this._maskModel),(this._textbox.value.indexOf("<")>=0||this._textbox.value.indexOf(">")>=0)&&(this._textbox.value=this._textbox.value.replace(/[<>]/g,""),this._maskModel=this._textbox.value,this._tempMask=this.model.maskFormat,this.model.maskFormat=this.model.maskFormat.replace(/[<>]/g,"")),this._textbox.value!=this._maskModel&&this._unStrippedMask!=null&&this.model.hidePromptOnLeave&&(this._textbox.value=this._unStrippedMask),n.fn.selectRange=function(n,t){return this.each(function(){if(this.setSelectionRange)this.focus(),this.setSelectionRange(n,t);else if(this.createTextRange){var i=this.createTextRange();i.collapse(!0);i.moveEnd("character",t);i.moveStart("character",n);i.select()}})},this.model.maskFormat&&n(this.element).selectRange(0,0),this._raiseEvents("focusIn"))},_OnBlurHandler:function(){var u,t,n,r;if(this.wrapper.removeClass("e-focus"),this.model.value=this.get_StrippedValue(),u=[],t=[],this._textbox.value.indexOf("_")!=-1||this._textbox.value.indexOf(" ")!=-1){for(n=0;n<this.model.maskFormat.length;n++)this.model.maskFormat[n]=="A"||this.model.maskFormat[n]=="?"?u.push(n):(this.model.maskFormat[n]=="9"||this.model.maskFormat[n]=="a"||this.model.maskFormat[n]=="C")&&t.push(n);for(n=0;n<u.length;n++)this._textbox.value[u[n]]==="_"&&(this._showAlert(),this.model.value=this._textbox.value);for(n=0;n<t.length;n++)if(this.model.value[t[n]]=="_"||this.model.value[t[n]]==" ")for(this.model.value=this.model.value.substr(0,t[n])+this.model.value.substr(t[n]+1,this.model.value.length),r=n;r<t.length;r++)t[r]=t[r]-1}this.model.value=this.model.value!=null?this.model.value.replace(/\s+/g,""):this.model.value;this._textbox.value!=i&&this.model.hidePromptOnLeave&&(this._unStrippedMask=this._textbox.value,this._textbox.value=this.get_UnstrippedValue());this.model.inputMode!="password"&&this._setWaterMark();this._raiseEvents("focusOut")},_OnKeyDownHandler:function(n){var i;if(!this.model.readOnly){if(this._keypressFlag=0,this._raiseEvents("onKeyDown"),this.element.removeClass("error"),this._maskLength==0)return!0;var r=n.keyCode?n.keyCode:n.charCode,f=String.fromCharCode(r),i=this._seekNext(),u=t.browserInfo().name;if(u=="msie"&&this._textbox.value==""&&(this._textbox.value=this.model.maskFormat.replace(/[9?CANa]/g,"_"),this._setCaretPosition(i)),r>=35&&r<=41&&(window.navigator.appCodeName=="Mozilla"||window.navigator.appCodeName=="opera")&&(this._keypressFlag=1),n.shiftKey&&(n.keyCode==35||n.keyCode==36||n.keyCode==37||n.keyCode==39||n.keyCode==46||n.keyCode==127)||n.ctrlKey&&(n.keyCode==86||n.keyCode==65||n.keyCode==67||n.keyCode==88)){this._keypressFlag=1;return}return r==8?this.model.inputMode!="password"?(this._keydownFlag=1,i=this._seekBefore(),this._raiseEvents("change"),this._selectedTextKeyDown||(i>=0&&i<this._maskLength&&this._writeBuffer("_",i),this._setCaretPosition(i)),this._keydownFlag=0,this._selectedTextKeyDown=0,n.preventDefault(),!1):(this._keypressFlag=1,!0):n.keyCode==46||n.keyCode==127?this.model.inputMode!="password"?(this._keydownFlag=2,i=this._seekNext(),this._raiseEvents("change"),this._selectedTextKeyDown||i>=0&&i<this._maskLength&&this._writeBuffer("_",i),this._keydownFlag=0,this._selectedTextKeyDown=0,n.preventDefault(),!1):(this._keypressFlag=1,!0):void 0}},_OnKeyPressHandler:function(n){if(!this.model.readOnly){if(this._raiseEvents("keyPress"),this._maskLength==0)return!0;var i=n.keyCode?n.keyCode:n.charCode,f=String.fromCharCode(i),u=this._seekNext(),r=t.browserInfo().name;if(this._validateChars(i,u)?(r=="mozilla"||r=="opera")&&(n.keyCode==35||n.keyCode==36||n.keyCode==37||n.keyCode==39)||(r=="mozilla"||r=="opera")&&n.ctrlKey&&(i==97||i==99||i==118||i==120)||(this._textbox.value==""&&(this._textbox.value=this.model.maskFormat.replace(/[9?$CANa*]/g,"_")),this._writeBuffer(f,u)):(r=="mozilla"||r=="opera")&&(n.keyCode==35||n.keyCode==36||n.keyCode==37||n.keyCode==39)||(r=="mozilla"||r=="opera")&&n.ctrlKey&&(i==97||i==99||i==118||i==120)||(this._textbox.value==""&&(this._textbox.value=this.model.maskFormat.replace(/[9?$CANa*]/g,"_")),this._setCaretPosition(u),this._showAlert()),!this._keypressFlag&&i!=9)return this._keypressFlag=0,n.preventDefault(),!1;this._keypressFlag=0}},_OnKeyUpHandler:function(){this._maskLength==0&&this._raiseEvents("change");this._raiseEvents("keyUp")},_OnMouseOverHandler:function(){this._raiseEvents("mouseOver")},_OnMouseOutHandler:function(){this._raiseEvents("mouseOut")},_raiseEvents:function(n){var t,i=this.get_StrippedValue(),r=this.get_UnstrippedValue();if(this.model.value=r,n=="change")if(this.previousValue!=this.model.value)this.previousValue=this.model.value;else return!1;t={value:r,unmaskedValue:i};this._trigger(n,t);this._trigger("_change",t);this._hiddenInput.val(i)},_OnValueChange:function(){this._textbox.value==""&&this._maskModel!=""&&(this._textbox.value=this._maskModel);this._setValue(this._textbox.value)}});t.InputMode={Password:"password",Text:"text"}})(jQuery,Syncfusion)})